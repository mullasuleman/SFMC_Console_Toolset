var getDEFieldList = () => { var e = null; if (document.querySelectorAll(".de-content-fields-listings").length <= 0) return "No Data Extension Found............................... Change iframe context to Email ⇓"; var t = []; return document.querySelectorAll(".de-listing-name-view").forEach((e => t.push(e.innerText))), t.length > 0 && (t => { console.log("Field List: \n\n" + t); var n, r = "fieldList_" + document.querySelector("#op-head-name-static").value, l = document.createElement("a"); l.setAttribute("download", `${r}.csv`), l.href = (n = new Blob([t], { type: "text/csv" }), null !== e && window.URL.revokeObjectURL(e), e = window.URL.createObjectURL(n)), l.click() })(t.join()), "Downloading file..." }, getDESchema = () => { var e = null; if (document.querySelectorAll(".de-content-fields-listings").length <= 0) return "No Data Extension Found............................... Change console context to iframe 'Email' ⇓"; var t = [], n = document.querySelector(".lg-head-breadcrumb").innerText.replaceAll("\n", " "), r = document.querySelector("#op-head-name-static").value, l = document.querySelector(".carb-input-popover.op-key-pop").value; t.push("Path: ," + n + ",,,,\n"), t.push("DE Name: ," + r + ",,,,\n"), t.push("External Key: ," + l + ",,,,\n"), t.push(",,,,,\n"), t.push("Field Name,Data Type,Length,Primary Key,Nullable,Default Value\n"); var o, c, i, d = document.querySelectorAll(".de-content-fields-listing").length - 1; return document.querySelectorAll(".de-content-fields-listing").forEach(((e, n) => { n != d && t.push(e.querySelector(".de-listing-name-view").innerText + "," + e.querySelector(".de-content-listing-txt span").innerText + "," + e.querySelector(".de-listing-length-view").innerText + "," + (e.querySelector(".de-content-listing-primary input").checked ? "Yes" : "") + "," + (e.querySelector(".de-content-listing-nullable input").checked ? "Yes" : "No") + "," + e.querySelector(".de-content-listing-dvalue-view").innerText + "\n") })), t.length > 0 && (o = t, c = document.querySelector("#op-head-name-static").value, (i = document.createElement("a")).setAttribute("download", `Schema_${c}.csv`), i.href = (t => { let n = new Blob(t, { type: "text/csv" }); return null !== e && window.URL.revokeObjectURL(e), e = window.URL.createObjectURL(n) })(o), i.click()), "Downloading file..." }, getDEFromFolder = () => { window.sfmcDEs = window.deList || []; var e = 1; console.log("Please wait..."); var t = setInterval((() => { console.log("Page " + e); var n = document.querySelectorAll(".grp-left.div-left .row").length - 1, r = []; for (document.querySelectorAll(".grp-center.header-center [data-property]").forEach((e => r.push(e.innerText))), i = 2; i <= n; i++) { var l = document.querySelector(".dg-head-breadcrumb.clearfix").innerText.replaceAll("\n", " ").trim() || "Data Extensions", o = document.querySelector(`.grp-left.div-left .row:nth-of-type(${i}) .cell:last-of-type`).innerText, c = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("Sendable") + 1})`).innerText, d = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("Record Count") + 1})`).innerText, a = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("Field Count") + 1})`).innerText, u = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("External Key") + 1})`).innerText; window.sfmcDEs.push({ folder: l, deName: o, externalKey: u, sendable: c, fieldCount: a, recordCount: d }) } var s = document.querySelector(".btn.grid-nextpage"); if ("disabled" == s.getAttribute("disabled")) return clearInterval(t), void console.table(window.sfmcLists); s.click(), e++ }), 1e3) }, getListsFromFolder = () => { window.sfmcLists = window.sfmcLists || []; var e = 1; console.log("Please wait..."); var t = setInterval((() => { console.log("Page " + e); var n = document.querySelectorAll(".grp-center.div-center .row").length, r = []; for (document.querySelectorAll(".grp-center.header-center [data-property]").forEach((e => r.push(e.innerText))), i = 2; i <= n - 1; i++) { var l = document.querySelector(".lg-head-breadcrumb.clearfix").innerText.replaceAll("\n", " ").trim() || "My Lists", o = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:first-of-type`).innerText, c = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("Subscriber Count") + 1})`).innerText, d = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("External Key") + 1})`).innerText, a = document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${r.indexOf("List ID") + 1})`).innerText; window.sfmcLists.push({ folder: l, deName: o, externalKey: d, listID: a, recordCount: c }) } var u = document.querySelector(".btn.grid-nextpage"); if ("disabled" == u.getAttribute("disabled")) return clearInterval(t), void console.table(window.sfmcLists); u.click(), e++ }), 5e3) }, DETools = { getFields: getDEFieldList, getSchema: getDESchema, getDEsFromFolder: getDEsFromFolder, getListsFromFolder: getListsFromFolder };
