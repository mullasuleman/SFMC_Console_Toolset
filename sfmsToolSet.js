var tf=null,mtf=e=>{var t=new Blob(e,{type:"text/csv"});return null!==tf&&window.URL.revokeObjectURL(tf),tf=window.URL.createObjectURL(t)},df=(e,t)=>{var r=document.createElement("a");r.setAttribute("download",`${t}.csv`),r.href=mtf(e),r.click()},getDEFieldList=()=>{if(document.querySelectorAll(".de-content-fields-listings").length<=0)return"No Data Extension Found............................... Change iframe context to Email ⇓";var e=[];return document.querySelectorAll(".de-listing-name-view").forEach((t=>e.push(t.innerText))),e.length>0&&df(e.join(),"fieldList_"+document.querySelector("#op-head-name-static").value),"Downloading file..."},getDESchema=()=>{if(document.querySelectorAll(".de-content-fields-listings").length<=0)return"No Data Extension Found............................... Change console context to iframe 'Email' ⇓";var e=[],t=document.querySelector(".lg-head-breadcrumb").innerText.replaceAll("\n"," "),r=document.querySelector("#op-head-name-static").value,n=document.querySelector(".carb-input-popover.op-key-pop").value;e.push("Path: ,"+t+",,,,\n"),e.push("DE Name: ,"+r+",,,,\n"),e.push("External Key: ,"+n+",,,,\n"),e.push(",,,,,\n"),e.push("Field Name,Data Type,Length,Primary Key,Nullable,Default Value\n");var o=document.querySelectorAll(".de-content-fields-listing").length-1;return document.querySelectorAll(".de-content-fields-listing").forEach(((t,r)=>{r!=o&&e.push(t.querySelector(".de-listing-name-view").innerText+","+t.querySelector(".de-content-listing-txt span").innerText+","+t.querySelector(".de-listing-length-view").innerText+","+(t.querySelector(".de-content-listing-primary input").checked?"Yes":"")+","+(t.querySelector(".de-content-listing-nullable input").checked?"Yes":"No")+","+t.querySelector(".de-content-listing-dvalue-view").innerText+"\n")})),e.length>0&&df(e,"Schema_"+document.querySelector("#op-head-name-static").value),"Downloading file..."},getListsFromFolder=()=>{window.sfmcLists=window.sfmcLists||[];var e=1;console.log("Please wait...");var t=setInterval((()=>{console.log("Page "+e);var r=document.querySelectorAll(".grp-center.div-center .row").length,n=[];for(document.querySelectorAll(".grp-center.header-center [data-property]").forEach((e=>n.push(e.innerText))),i=2;i<=r-1;i++){var o=document.querySelector(".lg-head-breadcrumb.clearfix").innerText.replaceAll("\n"," ").trim()||"My Lists",l=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:first-of-type`).innerText,c=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("Subscriber Count")+1})`).innerText,d=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("External Key")+1})`).innerText,a=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("List ID")+1})`).innerText;window.sfmcLists.push({folder:o,deName:l,externalKey:d,listID:a,recordCount:c})}var u=document.querySelector(".btn.grid-nextpage");if("disabled"==u.getAttribute("disabled"))return clearInterval(t),void console.table(window.sfmcLists);u.click(),e++}),5e3)},getDEFromFolder=()=>{window.sfmcDEs=window.deList||[];var e=1;console.log("Please wait...");var t=setInterval((()=>{console.log("Page "+e);var r=document.querySelectorAll(".grp-left.div-left .row").length-1,n=[];for(document.querySelectorAll(".grp-center.header-center [data-property]").forEach((e=>n.push(e.innerText))),i=2;i<=r;i++){var o=document.querySelector(".dg-head-breadcrumb.clearfix").innerText.replaceAll("\n"," ").trim()||"Data Extensions",l=document.querySelector(`.grp-left.div-left .row:nth-of-type(${i}) .cell:last-of-type`).innerText,c=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("Sendable")+1})`).innerText,d=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("Record Count")+1})`).innerText,a=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("Field Count")+1})`).innerText,u=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${n.indexOf("External Key")+1})`).innerText;window.sfmcDEs.push({folder:o,deName:l,externalKey:u,sendable:c,fieldCount:a,recordCount:d})}var s=document.querySelector(".btn.grid-nextpage");if("disabled"==s.getAttribute("disabled"))return clearInterval(t),void console.table(window.sfmcLists);s.click(),e++}),1e3)},DETools={getFields:getDEFieldList,getSchema:getDESchema,getDEsFromFolder:getDEsFromFolder,getListsFromFolder:getListsFromFolder};
