(function(){var e=null,t=t=>{var n=new Blob([t],{type:"text/csv"});return null!==e&&window.URL.revokeObjectURL(e),e=window.URL.createObjectURL(n),e},n=(e,n)=>{var o=document.createElement("a");o.setAttribute("download",`${n}.csv`),o.href=t(e),o.click()},o=e=>{let t=Object.keys(e[0]);const n=[Object.keys(e[0]),...e.map(e=>{let n=[];for(let o in t)n.push(e[t[o]].replaceAll(",",""));return n})].map(e=>e.join(",")).join("\n");return n},r=e=>{g.innerText=e,Object.assign(g.style,{bottom:"100px",opacity:"1"}),setTimeout(()=>{Object.assign(g.style,{bottom:"50px",opacity:"0"})},3e3)},l=e=>{console.log("copying..."),x.value=e,x.select(),document.execCommand("copy"),close()},c=()=>{if(document.querySelectorAll(".de-content-fields-listings").length<=0)return r("Please open a data extension first"),"No Data Extension Found............................... Change iframe context to Email ⇓";var e=[];document.querySelectorAll(".de-listing-name-view").forEach(t=>e.push(t.innerText)),e.length>0&&n(e.join(),"Blank_"+document.querySelector("#op-head-name-static").value),console.log(e.join()),l(e.join()),r("Downloading file...")},a=()=>{if(document.querySelectorAll(".de-content-fields-listings").length<=0)return r("Please open a data extension first"),"No Data Extension Found............................... Change iframe context to Email ⇓";var e=[];if(document.querySelectorAll(".de-listing-name-view").forEach(t=>e.push(t.innerText)),e.length>0){let n=e.map(e=>"DE.["+e+"]");var t="SELECT \n\t"+n.join(",\n\t")+" \nFROM \n\t["+document.querySelector("#op-head-name-static").value+"] as DE";l(t)}r("SQL Copied")},d=()=>{if(document.querySelectorAll(".de-content-fields-listings").length<=0)return r("Please open a data extension first"),"No Data Extension Found............................... Change iframe context to Email ⇓";var e=[],t=document.querySelector(".lg-head-breadcrumb").innerText.replaceAll("\n"," "),o=document.querySelector("#op-head-name-static").value,l=document.querySelector(".carb-input-popover.op-key-pop").value;e.push("Path: ,"+t+",,,,\n"),e.push("DE Name: ,"+o+",,,,\n"),e.push("External Key: ,"+l+",,,,\n"),e.push(",,,,,\n"),e.push("Field Name,Data Type,Length,Primary Key,Nullable,Default Value\n");var i=document.querySelectorAll(".de-content-fields-listing").length-1;document.querySelectorAll(".de-content-fields-listing").forEach((t,n)=>{n!=i&&e.push(t.querySelector(".de-listing-name-view").innerText+","+t.querySelector(".de-content-listing-txt span").innerText+',"'+t.querySelector(".de-listing-length-view").innerText+'",'+(t.querySelector(".de-content-listing-primary input").checked?"Yes":"")+","+(t.querySelector(".de-content-listing-nullable input").checked?"Yes":"No")+","+t.querySelector(".de-content-listing-dvalue-view").innerText+"\n")}),e.length>0&&n(e.join(""),"Schema_"+document.querySelector("#op-head-name-static").value),r("Downloading file...")},s=()=>{if(document.querySelector("#list-grid-prefs")){window.sfmcLists=window.sfmcLists||[];var e=1;console.log("Please wait...");var t=document.querySelector(".lg-head-breadcrumb.clearfix").innerText.replaceAll("\n"," ").trim()||"My Lists";document.querySelector("#list-grid-prefs").click(),document.querySelectorAll("#count, #listId, #customerKey").forEach(e=>e.checked=!0),document.querySelector("#gridPrefsOkBtn").click();var n=setInterval(()=>{r("Page "+e);var o=document.querySelectorAll(".grp-center.div-center .row"),l=o.length,c=[];for(document.querySelectorAll(".grp-center.header-center [data-property]").forEach(e=>c.push(e.innerText)),i=2;i<=l-1;i++){var a=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:first-of-type`).innerText,d=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("Subscriber Count")+1})`).innerText,s=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("External Key")+1})`).innerText,u=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("List ID")+1})`).innerText;window.sfmcLists.push({folder:t,listName:a,externalKey:s,listID:u,recordCount:d})}var p=document.querySelector(".btn.grid-nextpage");"disabled"==p.getAttribute("disabled")&&(clearInterval(n),console.table(window.sfmcLists),document.querySelector("#downloadLists span").innerText=" ("+window.sfmcLists.length+")",r(window.sfmcLists.length+" Lists Ready")),p.click(),e++},5e3)}else r("Please open List folder")},u=()=>{if(document.querySelector("#de-grid-prefs")){window.sfmcDEs=window.sfmcDEs||[];var e=1;console.log("Please wait...");var t=document.querySelector(".dg-head-breadcrumb.clearfix").innerText.replaceAll("\n"," ").trim()||"Data Extensions";document.querySelector("#de-grid-prefs").click(),document.querySelectorAll("#isSendable, #count, #fieldCount, #customerKey, #modifiedDate").forEach(e=>e.checked=!0),document.querySelector("#gridPrefsOkBtn").click();var n=setInterval(()=>{r("Page "+e);var o=document.querySelectorAll(".grp-left.div-left .row"),l=o.length-1,c=[];for(document.querySelectorAll(".grp-center.header-center [data-property]").forEach(e=>c.push(e.innerText)),i=2;i<=l;i++){var a=document.querySelector(`.grp-left.div-left .row:nth-of-type(${i}) .cell:last-of-type`).innerText,d=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("Sendable")+1})`).innerText,s=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("Record Count")+1})`).innerText.replaceAll(",",""),u=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("Field Count")+1})`).innerText,p=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("External Key")+1})`).innerText,f=document.querySelector(`.grp-center.div-center .row:nth-of-type(${i}) .cell:nth-of-type(${c.indexOf("Last Modified Date")+1})`).innerText;window.sfmcDEs.push({folder:t,deName:a,externalKey:p,sendable:d,fieldCount:u,recordCount:s,lastModified:f})}var m=document.querySelector(".btn.grid-nextpage");"disabled"==m.getAttribute("disabled")&&(clearInterval(n),console.table(window.sfmcDEs),document.querySelector("#downloadDEs span").innerText=" ("+window.sfmcDEs.length+")",r(window.sfmcDEs.length+" DEs Ready")),m.click(),e++},1e3)}else r("Please open data extension folder")},p=e=>{if(window.sfmcDEs){var t=o(window.sfmcDEs);t.length>0&&n(t,"DEs_"+(new Date).toLocaleDateString()),r("Downloading file...")}},f=e=>{if(window.sfmcLists){var t=o(window.sfmcLists);t.length>0&&n(t,"Lists_"+(new Date).toLocaleDateString()),r("Downloading file...")}},m=[{id:"getDEsFromFolder",func:u,label:"Scrape DEs"},{id:"downloadDEs",func:p,label:"Download DE List"},{id:"getListsFromFolder",func:s,label:"Scrape Lists"},{id:"downloadLists",func:f,label:"Download Lists"},{id:"getDESchema",func:d,label:"Download DE Schema"},{id:"getDEFieldList",func:c,label:"Download Blank CSV with Headers"},{id:"copySQL",func:a,label:"Copy SQL"}],y=document.createElement("div");y.id="sfmcToolSetSM",Object.assign(y.style,{position:"absolute","z-index":1e3,width:"max-content","max-width":"80vw",left:"50%",translate:"-50%",bottom:"9px",display:"flex","justify-content":"center","flex-wrap":"wrap",padding:"5px 10px","border-radius":"8px",background:"rgba(200, 200, 200, 0.7)","box-shadow":"rgba(0, 0, 0, 0.15) 1px 1px 2px 0px"}),m.forEach(e=>{let t=document.createElement("button");t.id=e.id,t.onclick=e.func,t.innerText=e.label,Object.assign(t.style,{background:"linear-gradient(to bottom,#fff,#dae5ed)",margin:"5px 5px",padding:"2px 5px","border-radius":"5px",border:"1px solid #b5c6d2","box-shadow":"1px 1px 2px 0 rgba(0,0,0,0.15)","font-size":"11px",width:"fit-content"}),y.append(t)});var g=document.createElement("div");g.id="toastSM",g.innerText="Loaded!",Object.assign(g.style,{position:"absolute",bottom:"50px",opacity:"0","z-index":1e3,width:"fit-content",left:"50%",translate:"-50%",display:"flex","justify-content":"center",padding:"10px 20px","border-radius":"20px",background:"rgba(200, 200, 200, 1)","box-shadow":"rgba(0, 0, 0, 0.15) 1px 1px 2px 0px",transition:"0.2s"}),y.append(g);var x=document.createElement("textarea");if(x.id="copyBox",Object.assign(x.style,{display:"inline",width:"0",height:"0",opacity:"0"}),y.append(x),!(document.querySelectorAll("#divContent").length>0))return"Please change iframe context by inspecting an element inside the Data Extension list/details view.";document.querySelector("#divContent").prepend(y),document.querySelector("#downloadDEs").append(document.createElement("span")),document.querySelector("#downloadLists").append(document.createElement("span"))})();